<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Actuators | OpenMQTTGateway v0.9.5</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
    <link rel="icon" href="/img/Openmqttgateway_logo_mini.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="One gateway, many technologies: MQTT gateway for ESP8266, ESP32, Sonoff RF Bridge or Arduino with bidirectional 433mhz/315mhz/868mhz, Infrared communications, BLE, beacons detection, mi flora / mi jia / LYWSD02/ Mi Scale compatibility, SMS & LORA.">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="preload" href="/assets/css/0.styles.f7b13cde.css" as="style"><link rel="preload" href="/assets/js/app.118d277f.js" as="script"><link rel="preload" href="/assets/js/2.b14f356c.js" as="script"><link rel="preload" href="/assets/js/37.9a07d2ad.js" as="script"><link rel="prefetch" href="/assets/js/10.075ed972.js"><link rel="prefetch" href="/assets/js/11.08d3c800.js"><link rel="prefetch" href="/assets/js/12.e655aa49.js"><link rel="prefetch" href="/assets/js/13.d4471ae1.js"><link rel="prefetch" href="/assets/js/14.9216f5e7.js"><link rel="prefetch" href="/assets/js/15.c6d2f6f6.js"><link rel="prefetch" href="/assets/js/16.f2a6197b.js"><link rel="prefetch" href="/assets/js/17.dc24704d.js"><link rel="prefetch" href="/assets/js/18.a4911dc2.js"><link rel="prefetch" href="/assets/js/19.16a692f5.js"><link rel="prefetch" href="/assets/js/20.f2106a12.js"><link rel="prefetch" href="/assets/js/21.49065d23.js"><link rel="prefetch" href="/assets/js/22.8979fc6c.js"><link rel="prefetch" href="/assets/js/23.b908b91b.js"><link rel="prefetch" href="/assets/js/24.125f220a.js"><link rel="prefetch" href="/assets/js/25.8e0d5830.js"><link rel="prefetch" href="/assets/js/26.f4fccf78.js"><link rel="prefetch" href="/assets/js/27.3586483f.js"><link rel="prefetch" href="/assets/js/28.e5b278c6.js"><link rel="prefetch" href="/assets/js/29.dd5ef034.js"><link rel="prefetch" href="/assets/js/3.761adb55.js"><link rel="prefetch" href="/assets/js/30.aab5773a.js"><link rel="prefetch" href="/assets/js/31.8f94e0af.js"><link rel="prefetch" href="/assets/js/32.d47d2a5a.js"><link rel="prefetch" href="/assets/js/33.5bdd2fec.js"><link rel="prefetch" href="/assets/js/34.d75d2224.js"><link rel="prefetch" href="/assets/js/35.199062c1.js"><link rel="prefetch" href="/assets/js/36.5d4d3a9a.js"><link rel="prefetch" href="/assets/js/38.ea7bafac.js"><link rel="prefetch" href="/assets/js/39.86b54919.js"><link rel="prefetch" href="/assets/js/4.54f5e0e4.js"><link rel="prefetch" href="/assets/js/40.5db84069.js"><link rel="prefetch" href="/assets/js/41.e6678afe.js"><link rel="prefetch" href="/assets/js/5.837069a6.js"><link rel="prefetch" href="/assets/js/6.3e85c22b.js"><link rel="prefetch" href="/assets/js/7.2eedfde4.js"><link rel="prefetch" href="/assets/js/8.3c69421a.js"><link rel="prefetch" href="/assets/js/9.cb23c1c5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f7b13cde.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">OpenMQTTGateway v0.9.5</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://1technophile.blogspot.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="https://community.openmqttgateway.com" target="_self" class="nav-link external">
  Community
  <!----></a></div><div class="nav-item"><a href="https://compatible.openmqttgateway.com/index.php/devices" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Devices
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://compatible.openmqttgateway.com/index.php/boards" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Boards
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/1technophile/OpenMQTTGateway" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://1technophile.blogspot.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="https://community.openmqttgateway.com" target="_self" class="nav-link external">
  Community
  <!----></a></div><div class="nav-item"><a href="https://compatible.openmqttgateway.com/index.php/devices" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Devices
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://compatible.openmqttgateway.com/index.php/boards" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Boards
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/1technophile/OpenMQTTGateway" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">0 - What is it for 🏠</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>1 - Prerequisites🧭</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2 - Set it up 🔨</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>3 - Upload ➡️</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>4 - Use ✈️</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/use/rf.html" class="sidebar-link">RF gateways  (433mhz/315mhz)</a></li><li><a href="/use/ble.html" class="sidebar-link">BLE gateway</a></li><li><a href="/use/ir.html" class="sidebar-link">IR gateway</a></li><li><a href="/use/lora.html" class="sidebar-link">LORA gateway</a></li><li><a href="/use/gsm.html" class="sidebar-link">GSM 2G gateway</a></li><li><a href="/use/rfm69.html" class="sidebar-link">RFM69 gateway</a></li><li><a href="/use/sensors.html" class="sidebar-link">Sensors</a></li><li><a href="/use/actuators.html" aria-current="page" class="active sidebar-link">Actuators</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/use/actuators.html#on-off" class="sidebar-link">ON OFF</a></li><li class="sidebar-sub-header"><a href="/use/actuators.html#fastled" class="sidebar-link">FASTLED</a></li><li class="sidebar-sub-header"><a href="/use/actuators.html#pwm" class="sidebar-link">PWM</a></li></ul></li><li><a href="/use/boards.html" class="sidebar-link">Boards</a></li><li><a href="/use/gateway.html" class="sidebar-link">System commands (ESP only)</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>5 - Integrate 🎉</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>6 - Participate 💻</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="actuators"><a href="#actuators" class="header-anchor">#</a> Actuators</h1> <h2 id="on-off"><a href="#on-off" class="header-anchor">#</a> ON OFF</h2> <p>This module enables to actuate things by giving to a PIN a HIGH or LOW value corresponding to an MQTT topic.
Example usage: Connect a transistor to power a relay, connect a led...</p> <p>So as to pilot the GPIO use the following commands with <a href="/upload/pio.html#api">simple receiving</a>:</p> <p>OFF command:
<code>mosquitto_pub -t home/OpenMQTTGateway_MEGA/commands/MQTTtoONOFF/setOFF -m 15</code></p> <p>ON command
<code>mosquitto_pub -t home/OpenMQTTGateway_MEGA/commands/MQTTtoONOFF/setON -m 15</code></p> <p>or with <a href="/upload/pio.html#api">json receiving</a></p> <p>OFF command:
<code>mosquitto_pub -t home/OpenMQTTGateway_MEGA/commands/MQTTtoONOFF -m '{&quot;gpio&quot;:15,&quot;cmd&quot;:0}'</code></p> <p>ON command
<code>mosquitto_pub -t home/OpenMQTTGateway_MEGA/commands/MQTTtoONOFF -m '{&quot;gpio&quot;:15,&quot;cmd&quot;:1}'</code></p> <h2 id="fastled"><a href="#fastled" class="header-anchor">#</a> FASTLED</h2> <h3 id="the-fastled-module-support-2-different-operation-modes"><a href="#the-fastled-module-support-2-different-operation-modes" class="header-anchor">#</a> The FASTLED module support 2 different operation modes</h3> <ol><li>control one specific RGB LED</li></ol> <ul><li>Set color</li> <li>Set blink</li></ul> <ol start="2"><li>Start fire animation (Fire2012)</li></ol> <h3 id="hardware-wiring"><a href="#hardware-wiring" class="header-anchor">#</a> Hardware wiring</h3> <p>Theoreticaly it should be possible to use every free IO pin. But after some tests only pin D2 works at WEMOS D1. Other platforms can work.
The default setting use NEOPIXEL (WS2812B). The simplest wiring is direct connect D2 to data pin of LED stripe and connect VCC/GND to power source. You should also add an capacitor.</p> <h2 id="pwm"><a href="#pwm" class="header-anchor">#</a> PWM</h2> <p>This module allows control over PWM outputs.
It's primary use is for controlling LEDs, but it should be equally at home controlling anything that's controlled using PWM.
E.g. LEDs, servos, PC fans.
You would typically connect a PWM output to a transistor or MOSFET to allow control over higher power devices.</p> <ul><li>JSON message format allows you to set any or all channels in a single message.</li> <li>Each channel can be set to smoothly transition from its current setting to the new setting over a specified number of seconds.</li> <li>Each channel can be calibrated with min and max settings, as well as a gamma curve.</li></ul> <h3 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h3> <p>In order to use the PWM actuator, you need to configure which pins the PWM output channels will be connected to.
There are a couple of <code>#define</code>s that achieve this.
They can be defined in the <code>build_flags</code> section of the env, or by directly editing <code>config_PWM.h</code>.</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">PWM_CHANNEL_NAMES <span class="token punctuation">{</span></span><span class="token string">&quot;r&quot;</span><span class="token expression"><span class="token punctuation">,</span> </span><span class="token string">&quot;g&quot;</span><span class="token expression"><span class="token punctuation">,</span> </span><span class="token string">&quot;b&quot;</span><span class="token expression"><span class="token punctuation">,</span> </span><span class="token string">&quot;w0&quot;</span><span class="token expression"><span class="token punctuation">,</span> </span><span class="token string">&quot;w1&quot;</span><span class="token expression"><span class="token punctuation">}</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">PWM_CHANNEL_PINS  <span class="token punctuation">{</span> <span class="token number">25</span><span class="token punctuation">,</span>  <span class="token number">33</span><span class="token punctuation">,</span>  <span class="token number">32</span><span class="token punctuation">,</span>   <span class="token number">23</span><span class="token punctuation">,</span>   <span class="token number">22</span><span class="token punctuation">}</span></span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>PWM_CHANNEL_NAMES</code> lists the names that you would like to assign to each channel, and determines the number of channels.
<code>PWM_CHANNEL_PINS</code> lists the corresponding output pins that the channels will be connected to.
The number of entries in <code>PWM_CHANNEL_PINS</code> must exactly match the number of entries in <code>PWM_CHANNEL_NAMES</code>.</p> <h3 id="usage"><a href="#usage" class="header-anchor">#</a> Usage</h3> <h4 id="set"><a href="#set" class="header-anchor">#</a> Set</h4> <p><code>mosquitto_pub -t home/OpenMQTTGateway_MEGA/commands/MQTTtoPWM/set -m '{&quot;r&quot;:0.5,&quot;g&quot;:0.2,&quot;b&quot;:1,&quot;fade&quot;:10.0}'</code></p> <p>This example sets new values for the channels named <code>r</code>, <code>g</code>, and <code>b</code>.
These channels will transition from their current values to the new values over 10s.</p> <h4 id="calibrate"><a href="#calibrate" class="header-anchor">#</a> Calibrate</h4> <p>Calibration allows that min and max levels to be configured for each channel, so that the full 0-1 range of values
that can be specified with the <code>set</code> command actually do things.</p> <p><code>mosquitto_pub -t home/OpenMQTTGateway_MEGA/commands/MQTTtoPWM/calibrate -m '{&quot;min-r&quot;:0.01,&quot;max-r&quot;:1.0,&quot;gamma-r&quot;:2.5}'</code></p> <p>This example calibrates the channel named <code>r</code>.
After this calibration, if you set the <code>r</code> channel to 0.0, it will be remapped to 0.01 internally.
Also, the gamma curve for this channel will be set to 2.5.
This means that input values are raised to the power 2.5 internally.
This can be used to improve the linearity of inputs.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/1technophile/OpenMQTTGateway/edit/development/docs/use/actuators.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/17/2020, 6:45:25 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/use/sensors.html" class="prev">
        Sensors
      </a></span> <span class="next"><a href="/use/boards.html">
        Boards
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.118d277f.js" defer></script><script src="/assets/js/2.b14f356c.js" defer></script><script src="/assets/js/37.9a07d2ad.js" defer></script>
  </body>
</html>
